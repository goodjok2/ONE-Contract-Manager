I made a mistake in the previous logic by focusing only on CRC. We need a "Dynamic Master Reset" that assigns correct sort orders to BOTH the CRC and CMOS versions of clauses so they share the same "slot".

**Task: Create and Run `scripts/reset-contract-structure-dynamic.ts`**

1.  **Define the "Shared Slot" Map:**
    Create a mapping that updates the `sortOrder` (and `name` where necessary) for the entire document.

    **Section 1:**
    * Slot 150: `ONE-1.5` ("1.5 On-Site Work - General")
    * **Slot 160 (The Split):**
        * `ONE-1.6-CRC` (Renamed from 1.5-CRC) -> "1.6. On-Site Work - CRC Client Acknowledgment"
        * `ONE-1.6-CMOS` (Renamed from 1.5-CMOS) -> "1.6. On-Site Work - CMOS Provisions"
    * Slot 170: `ONE-1.6` (Renamed to 1.7) -> "1.7. Custom Design Services"

    **Section 3:**
    * Slot 310-330: Sections 3.1, 3.2, 3.3
    * **Slot 340 (The Split):**
        * `ONE-3.4-CRC` -> Order 340
        * `ONE-3.4-CMOS` -> Order 340
    * Slot 350: `ONE-3.5-FINANCIAL` -> "3.5. Financial Obligations"
    * Slot 360: `ONE-3.5` -> "3.6. Green Light Conditions"

    **Section 5:**
    * Slot 530: `ONE-5.3` (Base text) -> "5.3. Site Readiness and Delivery Coordination"
    * **Slot 531 (The Split):**
        * `ONE-5.3-CRC` -> Order 531
        * `ONE-5.3-CMOS` -> Order 531

    **Section 7 (Restore Missing Headers):**
    * Slot 700: `ONE-SEC-7-HEADER` ("SECTION 7. RISK OF LOSS...")
    * Slot 710: `ONE-7.1` ("7.1. Risk of Loss")
    * Slot 720: `ONE-7.2` ("7.2. Title Transfer")
    * *Ensure IP clauses (Ownership, License) are deleted if present in this range.*

    **Restore Other Headers:**
    * Slot 800: `ONE-SEC-8-HEADER` ("SECTION 8. INDEMNIFICATION")
    * Slot 900: `ONE-SEC-9-HEADER` ("SECTION 9. LIMITATION OF LIABILITY")

2.  **Restore Data Fetching (Crucial):**
    * In `server/routes/contracts.ts`, ensure `with: { units: true }` is present in the `projects` query so Tables work.

3.  **Execute:**
    * Expose as `POST /api/debug/reset-dynamic` and run.

**Goal:** A structure where CRC and CMOS clauses sit in the exact same order slots, allowing the filter to swap them cleanly without breaking the numbering.