COMPLETE RESTART - Building from ACTUAL Contract Documents

STEP 0: CLEAR ALL FAKE DATA
Run this SQL to wipe everything:

DELETE FROM clauses;
DELETE FROM contract_variables;
DELETE FROM contract_templates;

Confirm this completes successfully before proceeding.

STEP 1: UNDERSTAND THE COMPLETE DOCUMENT STRUCTURE

The ONE Agreement has this full structure:

1. DOCUMENT SUMMARY (Pages 4-6)
   - Client-facing overview
   - Contains variables: {{PROJECT_NUMBER}}, {{PROJECT_NAME}}, {{AGREEMENT_EXECUTION_DATE}}, etc.
   - Explains the process phases and peace of mind guarantee

2. RECITALS (Pages 6-8) - CRITICAL LEGAL SECTION
   - Defines the parties and relationships
   - Contains the CRC vs CMOS election (Recital G) - THIS IS THE KEY CONDITIONAL LOGIC
   - Variables: {{DVELE_PARTNERS_XYZ_LEGAL_NAME}}, {{CLIENT_LEGAL_NAME}}, {{DELIVERY_ADDRESS}}, {{TOTAL_UNITS}}, {{ON_SITE_SERVICES_SELECTION}}, {{PRELIMINARY_CONTRACT_PRICE}}, etc.
   - This section drives most of the conditional clauses throughout the agreement

3. I. ATTACHMENTS (Page 8)
   - List of 6 exhibits (A-F)

4. II. AGREEMENT - Main Body (Pages 8-24)
   - Section 1: Scope of Services (1.1-1.6)
   - Section 2: Fees, Purchase Price, and Payment Terms (2.1-2.10)
   - Section 3: Client Responsibilities (3.1-3.5)
   - Section 4: Company Responsibilities (4.1-4.4)
   - Section 5: Project Schedule and Delays (5.1-5.6)
   - Section 6: Limited Warranty (6.1-6.6)
   - Section 7: Intellectual Property (7.1-7.5)
   - Section 8: Limitation of Liability (8.1-8.2)
   - Section 9: No Obligation to Purchase (9.1-9.5)
   - Section 10: Termination (10.1-10.6)
   - Section 11: Stepped Dispute Resolution (11.1-11.4)
   - Section 12: Default (12.1-12.3)
   - Section 13: Miscellaneous Provisions (13.1-13.8)

5. EXHIBITS A-F (Pages 26-38)
   - We'll handle these after the main agreement

STEP 2: EXTRACT ALL VARIABLES FROM ENTIRE DOCUMENT

Scan the COMPLETE document (Document Summary through all Sections and Exhibits) for every {{VARIABLE_NAME}} placeholder.

Expected variable categories:
- Project identifiers (PROJECT_NUMBER, PROJECT_NAME, etc.)
- Dates (AGREEMENT_EXECUTION_DATE, EFFECTIVE_DATE, etc.)
- Party information (DVELE_PARTNERS_XYZ_LEGAL_NAME, CLIENT_LEGAL_NAME, CLIENT_STATE, CLIENT_ENTITY_TYPE, etc.)
- Site/delivery (DELIVERY_ADDRESS, SITE_ADDRESS, TOTAL_UNITS, etc.)
- Financial (DESIGN_FEE, PRELIMINARY_CONTRACT_PRICE, PRELIMINARY_OFFSITE_PRICE, PRELIMINARY_ONSITE_PRICE, etc.)
- Service model (ON_SITE_SERVICES_SELECTION - this is critical!)
- Payment milestones (MILESTONE_1_PERCENT, MILESTONE_2_PERCENT, etc.)
- Warranty terms (DVELE_FIT_FINISH_WARRANTY, DVELE_ENVELOPE_WARRANTY, DVELE_STRUCTURAL_WARRANTY, etc.)
- Legal jurisdiction (PROJECT_STATE, PROJECT_STATE_CODE, PROJECT_COUNTY, PROJECT_FEDERAL_DISTRICT, etc.)
- And many more...

Create INSERT statements for contract_variables with:
- variable_name
- display_name (human readable)
- data_type (string, date, currency, number, boolean)
- category (project_info, party_info, financial, schedule, warranty, compliance, etc.)
- used_in_contracts: ARRAY['ONE']
- source_system: 'manual' (we'll update with 'odoo' later)
- description

Show me the complete list of variables found BEFORE inserting. Expected: 80-100+ variables.

STEP 3: PARSE DOCUMENT SUMMARY AS PREAMBLE

Create a special "preamble" section for the Document Summary:

- clause_code: 'ONE-PREAMBLE'
- hierarchy_level: 1
- name: 'Document Summary'
- content: The entire Document Summary text with all {{VARIABLES}} preserved
- category: 'preamble'
- This is NOT a numbered section, it comes before Section 1

STEP 4: PARSE RECITALS - THE MOST IMPORTANT PART

The RECITALS section contains the CRC vs CMOS conditional logic that affects the entire agreement.

Create these clause records:

ONE-RECITALS (Level 1, parent section)
  - Content: "RECITALS" header text
  
ONE-RECITAL-1 through ONE-RECITAL-9 (Level 2 subsections)
  - Each numbered recital as a separate clause
  - CRITICAL: Recital G contains two OPTIONS with conditional text
  
For Recital G specifically, create THREE clauses:
1. ONE-RECITAL-G (base text explaining the two options)
2. ONE-RECITAL-G-CRC (Option A text only)
   - conditions: {"ON_SITE_SERVICES_SELECTION": "CLIENT-RETAINED CONTRACTOR"}
3. ONE-RECITAL-G-CMOS (Option B text only)
   - conditions: {"ON_SITE_SERVICES_SELECTION": "COMPANY-MANAGED ON-SITE SERVICES"}

STEP 5: PARSE ATTACHMENTS LIST

Create ONE-ATTACHMENTS clause with the 6 exhibit list.

STEP 6: PARSE SECTION 1 ONLY (For Now)

Parse Section 1 "Scope of Services" with all its subsections (1.1-1.6).

IMPORTANT CONDITIONAL TEXT:
Throughout the document you'll see bracketed conditional text like:

[IF CLIENT HAS ELECTED 'CLIENT-RETAINED CONTRACTOR (CRC)':]
...CRC-specific text...

[IF CLIENT HAS ELECTED 'COMPANY-MANAGED ON-SITE SERVICES (CMOS)':]
...CMOS-specific text...

When you encounter these, create sep